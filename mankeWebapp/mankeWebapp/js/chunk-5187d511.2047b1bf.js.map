{"version":3,"sources":["webpack:///./src/views/profile/edit.vue?031b","webpack:///src/views/profile/edit.vue","webpack:///./src/views/profile/edit.vue?4cc8","webpack:///./src/views/profile/edit.vue","webpack:///./node_modules/vant/es/form/style/index.js","webpack:///./node_modules/vant/es/form/index.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticStyle","on","onSubmit","attrs","avatar","staticClass","avatarChange","model","value","callback","$$v","$set","expression","password","age","gender","$event","showPicker","columns","onConfirm","_v","staticRenderFns","data","username","imageUrl","methods","component","_createNamespace","createComponent","bem","props","colon","Boolean","labelWidth","Number","String","labelAlign","inputAlign","scrollToError","validateFirst","errorMessageAlign","submitOnEnter","type","default","validateTrigger","showError","showErrorMessage","provide","vanForm","fields","validateSeq","_this","Promise","resolve","reject","errors","reduce","promise","field","then","length","validate","error","push","validateAll","_this2","all","map","item","filter","name","validateField","matched","resetValidation","forEach","scrollToField","options","$el","scrollIntoView","addField","removeField","getValues","form","formValue","event","preventDefault","submit","_this3","values","$emit","catch","h","arguments","slots"],"mappings":"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","file":"js/chunk-5187d511.2047b1bf.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('van-form',{staticStyle:{\"margin-top\":\"30px\"},on:{\"submit\":_vm.onSubmit}},[_c('div',{staticStyle:{\"text-align\":\"center\"}},[_c('van-image',{attrs:{\"round\":\"\",\"width\":\"10rem\",\"height\":\"10rem\",\"src\":_vm.avatar?_vm.avatar:'../vant/cat.jpeg'}}),_c('input',{staticClass:\"form-control-file\",staticStyle:{\"width\":\"220px\"},attrs:{\"type\":\"file\"},on:{\"change\":_vm.avatarChange}})],1),_c('van-field',{staticStyle:{\"padding-left\":\"30px\",\"margin-top\":\"30px\",\"font-size\":\"16px\"},attrs:{\"name\":\"用户名\",\"label\":\"用户名\",\"placeholder\":\"用户名\",\"disabled\":\"\"},model:{value:(this.username),callback:function ($$v) {_vm.$set(this, \"username\", $$v)},expression:\"this.username\"}}),_c('van-field',{staticStyle:{\"padding-left\":\"30px\",\"font-size\":\"16px\"},attrs:{\"type\":\"password\",\"name\":\"密码\",\"label\":\"密码\",\"placeholder\":\"密码\"},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}}),_c('van-field',{staticStyle:{\"padding-left\":\"30px\",\"font-size\":\"16px\"},attrs:{\"name\":\"年龄\",\"label\":\"年龄\",\"placeholder\":\"年龄\"},model:{value:(_vm.age),callback:function ($$v) {_vm.age=$$v},expression:\"age\"}}),_c('van-field',{staticStyle:{\"padding-left\":\"30px\"},attrs:{\"readonly\":\"\",\"clickable\":\"\",\"label\":\"性别\",\"value\":_vm.gender,\"placeholder\":\"选择\"},on:{\"click\":function($event){_vm.showPicker = true}}}),_c('van-popup',{attrs:{\"round\":\"\",\"position\":\"bottom\"},model:{value:(_vm.showPicker),callback:function ($$v) {_vm.showPicker=$$v},expression:\"showPicker\"}},[_c('van-picker',{attrs:{\"show-toolbar\":\"\",\"columns\":_vm.columns},on:{\"cancel\":function($event){_vm.showPicker = false},\"confirm\":_vm.onConfirm}})],1),_c('div',{staticStyle:{\"margin\":\"26px 16px\"}},[_c('van-button',{attrs:{\"round\":\"\",\"block\":\"\",\"type\":\"info\",\"native-type\":\"submit\"}},[_vm._v(\"修改\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <van-form @submit=\"onSubmit\" style=\"margin-top: 30px\">\r\n    <div style=\"text-align:center\">\r\n      <van-image round width=\"10rem\" height=\"10rem\" :src=\"avatar?avatar:'../vant/cat.jpeg'\" />\r\n      <input type=\"file\" class=\"form-control-file\" @change=\"avatarChange\" style=\"width:220px\" />\r\n    </div>\r\n    <van-field\r\n      v-model=\"this.username\"\r\n      name=\"用户名\"\r\n      label=\"用户名\"\r\n      placeholder=\"用户名\"\r\n      style=\"padding-left: 30px;margin-top:30px; font-size: 16px\"\r\n      disabled\r\n    />\r\n    <van-field\r\n      v-model=\"password\"\r\n      type=\"password\"\r\n      name=\"密码\"\r\n      label=\"密码\"\r\n      placeholder=\"密码\"\r\n      style=\"padding-left: 30px; font-size: 16px\"\r\n    />\r\n    <van-field\r\n      v-model=\"age\"\r\n      name=\"年龄\"\r\n      label=\"年龄\"\r\n      placeholder=\"年龄\"\r\n      style=\"padding-left: 30px; font-size: 16px\"\r\n    />\r\n    <van-field\r\n      style=\"padding-left: 30px\"\r\n      readonly\r\n      clickable\r\n      label=\"性别\"\r\n      :value=\"gender\"\r\n      placeholder=\"选择\"\r\n      @click=\"showPicker = true\"\r\n    />\r\n    <van-popup v-model=\"showPicker\" round position=\"bottom\">\r\n      <van-picker\r\n        show-toolbar\r\n        :columns=\"columns\"\r\n        @cancel=\"showPicker = false\"\r\n        @confirm=\"onConfirm\"\r\n      />\r\n    </van-popup>\r\n    <div style=\"margin: 26px 16px;\">\r\n      <van-button round block type=\"info\" native-type=\"submit\">修改</van-button>\r\n    </div>\r\n  </van-form>\r\n</template>\r\n<script>\r\nimport Vue from \"vue\";\r\nimport { Form, Toast } from \"vant\";\r\nimport { Picker } from \"vant\";\r\nimport { Popup } from \"vant\";\r\nVue.use(Toast);\r\nVue.use(Popup);\r\nVue.use(Picker);\r\nVue.use(Form);\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      username: \"\",\r\n      password: \"\",\r\n      age: 1,\r\n      gender: \"\",\r\n      showPicker: false,\r\n      columns: [\"男\", \"女\", \"保密\"],\r\n      imageUrl: \"\",\r\n      avatar: \"\",\r\n    };\r\n  },\r\n  methods: {\r\n    onConfirm(value) {\r\n      this.gender = value;\r\n      this.showPicker = false;\r\n    },\r\n    async onSubmit() {\r\n      let currentUser = localStorage.getItem(\"currentUser\");\r\n      currentUser = JSON.parse(currentUser);\r\n      let _id = currentUser._id;\r\n      this._id = _id;\r\n      const { data } = await this.$request.put(\"/user/\" + _id, {\r\n        params: {\r\n          username: this.username,\r\n          password: this.password,\r\n          age: this.age,\r\n          gender: this.gender,\r\n        },\r\n      });\r\n      if (data.code === 1) {\r\n        Toast(\"修改成功\");\r\n        data.data.gender ? (this.gender = data.data.gender) : this.gender;\r\n        data.data.age ? (this.age = data.data.age) : this.age;\r\n        data.data.avatarUrl ? (this.avatar = data.data.avatarUrl) : this.avatar;\r\n        if(data.data.password){\r\n          this.$router.push({name: \"Login\"})\r\n        }   \r\n      }\r\n    },\r\n    async avatarChange(e) {\r\n      let currentUser = localStorage.getItem(\"currentUser\");\r\n      currentUser = JSON.parse(currentUser);\r\n      const id = currentUser._id;\r\n      const data = new FormData();\r\n      data.set(\"_id\", id);\r\n      data.set(\"avatar\", e.target.files[0]);\r\n\r\n      const result = await this.$request.post(\"/upload/user\", data, {\r\n        contentType: false,\r\n      });\r\n\r\n      this.avatar = result.avatarUrl;\r\n      // 更新本地存储数据\r\n      if (id === currentUser._id) {\r\n        currentUser.avatarUrl = result.avatarUrl;\r\n        localStorage.setItem(\"currentUser\", JSON.stringify(currentUser));\r\n      }\r\n    },\r\n  },\r\n  async created() {\r\n    let currentUser = localStorage.getItem(\"currentUser\");\r\n    currentUser = JSON.parse(currentUser);\r\n    let _id = currentUser._id;\r\n    const { data } = await this.$request.get(\"/user/\" + _id);\r\n    this.username = data.data.username;\r\n    this.gender = data.data.gender;\r\n    this.age = data.data.age;\r\n    this.avatar = data.data.avatarUrl;\r\n  },\r\n};\r\n</script>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./edit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./edit.vue?vue&type=template&id=749c55fe&\"\nimport script from \"./edit.vue?vue&type=script&lang=js&\"\nexport * from \"./edit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import '../../style/base.css';\n","import { createNamespace } from '../utils';\nimport { sortChildren } from '../utils/vnodes';\n\nvar _createNamespace = createNamespace('form'),\n    createComponent = _createNamespace[0],\n    bem = _createNamespace[1];\n\nexport default createComponent({\n  props: {\n    colon: Boolean,\n    labelWidth: [Number, String],\n    labelAlign: String,\n    inputAlign: String,\n    scrollToError: Boolean,\n    validateFirst: Boolean,\n    errorMessageAlign: String,\n    submitOnEnter: {\n      type: Boolean,\n      default: true\n    },\n    validateTrigger: {\n      type: String,\n      default: 'onBlur'\n    },\n    showError: {\n      type: Boolean,\n      default: true\n    },\n    showErrorMessage: {\n      type: Boolean,\n      default: true\n    }\n  },\n  provide: function provide() {\n    return {\n      vanForm: this\n    };\n  },\n  data: function data() {\n    return {\n      fields: []\n    };\n  },\n  methods: {\n    validateSeq: function validateSeq() {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        var errors = [];\n\n        _this.fields.reduce(function (promise, field) {\n          return promise.then(function () {\n            if (!errors.length) {\n              return field.validate().then(function (error) {\n                if (error) {\n                  errors.push(error);\n                }\n              });\n            }\n          });\n        }, Promise.resolve()).then(function () {\n          if (errors.length) {\n            reject(errors);\n          } else {\n            resolve();\n          }\n        });\n      });\n    },\n    validateAll: function validateAll() {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n        Promise.all(_this2.fields.map(function (item) {\n          return item.validate();\n        })).then(function (errors) {\n          errors = errors.filter(function (item) {\n            return item;\n          });\n\n          if (errors.length) {\n            reject(errors);\n          } else {\n            resolve();\n          }\n        });\n      });\n    },\n    // @exposed-api\n    validate: function validate(name) {\n      if (name) {\n        return this.validateField(name);\n      }\n\n      return this.validateFirst ? this.validateSeq() : this.validateAll();\n    },\n    validateField: function validateField(name) {\n      var matched = this.fields.filter(function (item) {\n        return item.name === name;\n      });\n\n      if (matched.length) {\n        return new Promise(function (resolve, reject) {\n          matched[0].validate().then(function (error) {\n            if (error) {\n              reject(error);\n            } else {\n              resolve();\n            }\n          });\n        });\n      }\n\n      return Promise.reject();\n    },\n    // @exposed-api\n    resetValidation: function resetValidation(name) {\n      this.fields.forEach(function (item) {\n        if (!name || item.name === name) {\n          item.resetValidation();\n        }\n      });\n    },\n    // @exposed-api\n    scrollToField: function scrollToField(name, options) {\n      this.fields.forEach(function (item) {\n        if (item.name === name) {\n          item.$el.scrollIntoView(options);\n        }\n      });\n    },\n    addField: function addField(field) {\n      this.fields.push(field);\n      sortChildren(this.fields, this);\n    },\n    removeField: function removeField(field) {\n      this.fields = this.fields.filter(function (item) {\n        return item !== field;\n      });\n    },\n    getValues: function getValues() {\n      return this.fields.reduce(function (form, field) {\n        form[field.name] = field.formValue;\n        return form;\n      }, {});\n    },\n    onSubmit: function onSubmit(event) {\n      event.preventDefault();\n      this.submit();\n    },\n    // @exposed-api\n    submit: function submit() {\n      var _this3 = this;\n\n      var values = this.getValues();\n      this.validate().then(function () {\n        _this3.$emit('submit', values);\n      }).catch(function (errors) {\n        _this3.$emit('failed', {\n          values: values,\n          errors: errors\n        });\n\n        if (_this3.scrollToError) {\n          _this3.scrollToField(errors[0].name);\n        }\n      });\n    }\n  },\n  render: function render() {\n    var h = arguments[0];\n    return h(\"form\", {\n      \"class\": bem(),\n      \"on\": {\n        \"submit\": this.onSubmit\n      }\n    }, [this.slots()]);\n  }\n});"],"sourceRoot":""}